# Migration `20200701124231-initial`

This migration has been generated by Micha≈Ç Lytek at 7/1/2020, 12:42:31 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "Role" AS ENUM ('USER', 'ADMIN');

CREATE TYPE "PostKind" AS ENUM ('BLOG', 'ADVERT');

CREATE TABLE "public"."User" (
"age" integer  NOT NULL ,"amount" Decimal(65,30)  NOT NULL ,"balance" Decimal(65,30)  NOT NULL ,"email" text  NOT NULL ,"id" SERIAL,"name" text   ,"role" "Role" NOT NULL ,
    PRIMARY KEY ("id"))

CREATE TABLE "public"."post" (
"authorId" integer  NOT NULL ,"content" text   ,"createdAt" timestamp(3)  NOT NULL DEFAULT CURRENT_TIMESTAMP,"kind" "PostKind"  ,"metadata" jsonb  NOT NULL ,"published" boolean  NOT NULL ,"title" text  NOT NULL ,"updatedAt" timestamp(3)  NOT NULL ,"uuid" text  NOT NULL ,
    PRIMARY KEY ("uuid"))

CREATE TABLE "public"."Category" (
"name" text  NOT NULL ,"number" integer  NOT NULL ,"slug" text  NOT NULL )

CREATE TABLE "public"."Patient" (
"email" text  NOT NULL ,"firstName" text  NOT NULL ,"lastName" text  NOT NULL ,
    PRIMARY KEY ("firstName","lastName"))

CREATE TABLE "public"."Movie" (
"directorFirstName" text  NOT NULL ,"directorLastName" text  NOT NULL ,"title" text  NOT NULL ,
    PRIMARY KEY ("directorFirstName","directorLastName","title"))

CREATE TABLE "public"."Director" (
"firstName" text  NOT NULL ,"lastName" text  NOT NULL ,
    PRIMARY KEY ("firstName","lastName"))

CREATE UNIQUE INDEX "User.email" ON "public"."User"("email")

CREATE UNIQUE INDEX "Category.slug_number" ON "public"."Category"("slug","number")

ALTER TABLE "public"."post" ADD FOREIGN KEY ("authorId")REFERENCES "public"."User"("id") ON DELETE CASCADE  ON UPDATE CASCADE

ALTER TABLE "public"."Movie" ADD FOREIGN KEY ("directorFirstName", "directorLastName")REFERENCES "public"."Director"("firstName","lastName") ON DELETE CASCADE  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration ..20200701124231-initial
--- datamodel.dml
+++ datamodel.dml
@@ -1,0 +1,96 @@
+datasource db {
+  provider = "postgresql"
+  url = "***"
+}
+
+type Numeric = Float
+
+generator client {
+  provider      = "prisma-client-js"
+  binaryTargets = ["windows", "debian-openssl-1.1.x"]
+  output        = "../prisma/generated/client"
+}
+
+generator typegraphql {
+  provider = "node ../src/cli/dev.ts"
+  output   = "../prisma/generated/type-graphql"
+  emitDMMF = true
+}
+
+// Role enum comment
+/// Role enum doc
+enum Role {
+  USER
+  ADMIN
+}
+
+// User model comment
+/// User model doc
+/// @@TypeGraphQL.type("Client")
+model User {
+  // User model field comment
+  /// User model field doc
+  id      Int     @default(autoincrement()) @id
+  email   String  @unique
+  /// renamed field doc
+  /// @TypeGraphQL.field("firstName")
+  name    String?
+  age     Int
+  /// @TypeGraphQL.field("accountBalance")
+  balance Numeric
+  amount  Float
+  /// @TypeGraphQL.field("clientPosts")
+  posts   post[]
+  role    Role
+}
+
+enum PostKind {
+  BLOG
+  ADVERT
+}
+
+model post {
+  uuid      String    @default(uuid()) @id
+  createdAt DateTime  @default(now())
+  updatedAt DateTime  @updatedAt
+  published Boolean
+  title     String
+  content   String?
+  author    User      @relation(fields: [authorId], references: [id])
+  authorId  Int
+  kind      PostKind?
+  metadata  Json
+}
+
+model Category {
+  name   String
+  slug   String
+  number Int
+
+  @@unique([slug, number])
+}
+
+model Patient {
+  firstName String
+  lastName  String
+  email     String
+
+  @@id([firstName, lastName])
+}
+
+model Movie {
+  directorFirstName String
+  directorLastName  String
+  director          Director @relation(fields: [directorFirstName, directorLastName], references: [firstName, lastName])
+  title             String
+
+  @@id([directorFirstName, directorLastName, title])
+}
+
+model Director {
+  firstName String
+  lastName  String
+  movies    Movie[]
+
+  @@id([firstName, lastName])
+}
```


